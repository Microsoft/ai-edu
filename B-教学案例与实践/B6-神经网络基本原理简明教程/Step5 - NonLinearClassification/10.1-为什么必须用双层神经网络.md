Copyright © Microsoft Corporation. All rights reserved.
  适用于[License](https://github.com/Microsoft/ai-edu/blob/master/LICENSE.md)版权许可

## 10.1 为什么必须用双层神经网络

### 10.1.1 简单证明异或的可能性

用单个感知机或者单层神经网络，是否能完成异或任务呢？我们自己做个简单的证明。先看样本数据：

|样本|x1|x2|y|
|---|---|---|---|
|1|0|0|0|
|2|0|1|1|
|3|1|0|1|
|4|1|1|0|

用单个神经元（感知机）的话，就是下图：

|神经元|分类函数Logistic|
|--|--|
|<img src='../Images/10/xor_prove.png' width="400"/>|<img src='../Images/8/sigmoid_seperator.png' width="430"/>|

前向计算公式：

$$z = x_1  w_1 + x_2  w_2 + b \tag{1}$$
$$a = Logistic(z) \tag{2}$$

- 对于第一个样本数据

x1=0, x2=0, y=0。如果需要a=y的话，从Logistic函数曲线看，需要z<0，于是有：

$$x_1 w_1 + x_2  w_2 + b < 0$$

因为x1=0，x2=0，所以只剩下b项：

$$b < 0 \tag{3}$$

- 对于第二个样本数据

x1=0，x2=1，y=1。如果需要a=y，则要求z值大于0，不等式为：

$$x_1w_1 + x_2w_2+b=w_2+b > 0 \tag{4}$$

- 对于第三个样本数据

x1=1，x2=0，y=1。如果需要a=y，则要求z值大于0，不等式为：

$$x_1w_1 + x_2w_2+b=w_1+b > 0 \tag{5}$$

- 对于第四个样本

x1=1，x2=1，y=0。如果需要a=y，则要求z值小于0，不等式为：

$$x_1w_1 + x_2w_2+b=w_1+w_2+b < 0 \tag{6}$$

把公式6两边都加b，并把公式3接续：

$$(w_1 + b) + (w_2 + b) < b < 0 \tag{7}$$

再看公式4、5，不等式左侧括号内的两个因子都大于0，其和必然也大于0，不可能小于b。因此公式7不成立，无论如何也不能满足所有的4个样本的条件，所以单个神经元做异或运算是不可能的。

### 10.1.2 利用已有的知识解决问题

我们前边学习过如何实现与、与非、或、或非，我们看看如何用已有的逻辑搭建异或门：

<img src='../Images/10/xor_gate.png'/>

|样本|1|2|3|4|
|----|----|----|----|----|
|x1|0|0|1|1|
|x2|0|1|0|1|
|x1 AND x2|0|0|0|1|
|s1=x1 NAND x2|1|1|1|0|
|s2=x1 OR x1|0|1|1|1|
|y=s1 AND s2|0|1|1|0|


经过以上组合运算后，可以看到y的输出与x1,x2的输入相比，就是异或逻辑了。所以，实践证明两层神经网络可以解决问题。我们可以模拟这个思路，用两层神经网络搭建模型。
