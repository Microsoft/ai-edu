Copyright © Microsoft Corporation. All rights reserved.
  适用于[License](https://github.com/Microsoft/ai-edu/blob/master/LICENSE.md)版权许可

# 第9章 单入单出的双层神经网络

## 9.0 非线性回归

### 9.0.1 提出问题一

我们在第5章学习了线性回归的解决方案，但是在工程实践中，我们最常遇到不是线性问题，而是非线性问题。例如下面这条正弦曲线：

<img src="../Images/9/sin_data.png">

|样本|x|y|
|---|---|---|
|1|0.1199|0.6108|
|2|0.0535|0.3832|
|3|0.6978|0.9496|
|...|...|...|

问题：使用神经网络如何拟合一条有很强规律的曲线，比如正弦曲线？

### 9.0.3 提出问题二

前面的正弦函数，看上去是非常有规律的，也许单层神经网络很容易就做到了。如果是更复杂的曲线，单层神经网络还能轻易做到吗？比如下面这张图，给出如下一批训练数据，如何使用神经网络方法来拟合这条曲线？

<img src="..\Images\9\Sample.png">

|样本|x|y|
|---|---|---|
|1|0.606|-0.113|
|2|0.129|-0.269|
|3|0.582|0.027|
|...|...|...|
|1000|0.199|-0.281|

原则上说，如果你有足够的耐心，愿意花很高的时间成本和计算资源，总可以用多项式回归的方式来解决这个问题，但是，在本章，我们将会学习另外一个定理：前馈神经网络的通用近似定理。

上面这条“蛇形”曲线，实际上是由下面这个公式添加噪音后生成的：

$$y=0.4x^2 + 0.3xsin(15x) + 0.01cos(50x)-0.3$$

我们特意把数据限制在[0,1]之间，避免做归一化的麻烦。要是觉得这个公式还不够复杂，大家可以用更复杂的公式去自己做试验。

以上问题可以叫做非线性回归，即自变量X和因变量Y之间不是线性关系。常用的传统的处理方法有线性迭代法、分段回归法、迭代最小二乘法等。在神经网络中，解决这类问题的思路非常简单，就是使用带有一个隐层的两层神经网络。

### 9.0.3 解决方案

在本章中，我们将学习两种解决方案，专门用于拟合曲线。

“曲线”在这里是一个广义的概念，它可以代表二维平面上的数学曲线，也可以代表工程实践中的任何拟合问题，比如具有10多个自变量的房价预测问题，或者是高速公路的车流量预测问题。

利用第二步中学到的线性回归的知识，可以部分地解决曲线拟合问题，就是所谓的多项式回归。在神经网络出现之前，多项式回归是人们解决这种问题的重要手段。

更复杂的曲线拟合问题，虽然也可以勉强使用多项式回归，但是训练成本高，解决问题的思路单一，近似程度也不够好。所以我们将会在本章中学习另外一种双层神经网络的解决方案。
