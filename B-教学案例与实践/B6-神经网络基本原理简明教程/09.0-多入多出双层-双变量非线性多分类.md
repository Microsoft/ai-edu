Copyright © Microsoft Corporation. All rights reserved.
  适用于[License](https://github.com/Microsoft/ai-edu/blob/master/LICENSE.md)版权许可

# 知识点

- [非线性多分类实现](09.1-非线性多分类实现.md)
- [非线性多分类结果可视化](09.2-非线性多分类结果可视化.md)
- [梯度下降优化算法](09.3-梯度下降优化算法.md)
- [自适应学习率算法](09.4-自适应学习率算法.md)

# 提出问题

前面我们学习了线性二分类与多分类。升级为两层的神经网络之后，我们看看如何用它来做非线性的二分类与多分类。

我们有如下1000个样本和标签：

|样本序号|1|2|3|...|1000|
|---|---|---|---|--|--|---|
|x1|0.0091867|0.10245588|-0.41033773|...|-0.20625644|
|x2|0.00666677|0.20947882|0.18172314|...|0.19683694|
|y|1|2|3|...|2|

还好这个数据只有两个特征，所以我们可以用可视化的方法展示，如下图：

<img src='./Images/9/data.png'/>

1. 绿色点
2. 红色点
3. 蓝色点

三种颜色的点有规律地占据了一个单位平面内(-0.5,0.5)的不同区域，从图中可以明显看出，这不是线性可分问题，而单层神经网络只能做线性分类，如果想做非线性分类，需要至少两层神经网络来完成。

木头：我觉得红蓝两色是圆形边界分割，红绿两色是个矩形边界，都是有规律的。

铁柱：学习神经网络，要忘记“规律”这个词，对于神经网络来说，数学上的“有规律”或者“无规律”是没有意义的，对于它来说都是无规律，训练难度是一模一样的。

**问题：如何用两层神经网络实现这个三分类问题？**

# 下载训练数据

[点击下载训练样本数据X](https://github.com/Microsoft/ai-edu/tree/master/B-%E6%95%99%E5%AD%A6%E6%A1%88%E4%BE%8B%E4%B8%8E%E5%AE%9E%E8%B7%B5/B6-%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86%E7%AE%80%E6%98%8E%E6%95%99%E7%A8%8B/Data/X9_3.npy)

[点击下载训练样本数据Y](https://github.com/Microsoft/ai-edu/tree/master/B-%E6%95%99%E5%AD%A6%E6%A1%88%E4%BE%8B%E4%B8%8E%E5%AE%9E%E8%B7%B5/B6-%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86%E7%AE%80%E6%98%8E%E6%95%99%E7%A8%8B/Data/Y9_3.npy)

# 非线性分类问题

我们先比较一下线性/非线性，二分类/多分类的含义：

||二分类|多分类|
|---|---|---|
|线性|<img src=".\Images\7\linear_binary.png"/>|<img src=".\Images\7\linear_multiple.png"/>|
|非线性|<img src=".\Images\7\non_linear_binary.png"/>|<img src=".\Images\7\non_linear_multiple.png"/>|

单层神经网络只能实现线性分类，虽然可以用一些特征的高阶形式来拟合有限的曲线，但要想实现真正的非线性分类，必须使用两层以上的神经网络。

在两层神经网络的输出层，可以用和单层神经网络一样的结构来完成分类任务，而用隐层来完成非线性到线性的转换工作。我们可以通过以下几张图的比较来理解一下非线性到线性的转换。

以下图片均来自于[Christopher Olah的博客](https://colah.github.io/posts/2014-03-NN-Manifolds-Topology/)。

假设有两组点组成的红蓝两色曲线如下图：

<img src=".\Images\9\simple2_data.png"/>

我们如何用神经网络画一条直线或者曲线来把红蓝两线分开呢？用一层的神经网络可以做到这样：

<img src=".\Images\9\simple2_linear.png"/>

神经网络已经很努力地把损失函数值降到最低了，但是由于能力有限，没有完成任务。于是我们考虑两层神经网络，它能很轻松地画一条曲线来区分红蓝两色：

<img src=".\Images\9\simple2_0.png"/>

我们不禁要奇怪它是如何做到的？其实神经网络的第二层还是只能画一条直线，而最神奇的地方是第一层，加上激活函数后，它可以做到坐标转换和空间扭曲：

<img src=".\Images\9\simple2_1.png"/>

从上图中可以看出，第一层计算，把坐标空间扭曲，然后第二层神经网络轻松地画了一条直线，就把二者完美分开了。
